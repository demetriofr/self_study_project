# **Сервис для самообучения.**                                                       
_(project name: self_study_project)_                                                                                                 
                                                                                                                                    
**Цель проекта:** Реализовать сервис для самообучения работников организаций (далее - обучающихся) охране труда и 
смежным вопросам производственной безопасности на платформе, которая работает только с авторизованными пользователями.

**Этап данного проекта:** _MVP_



### Направление 
Backend.



### Тэги
![Python 3.12](https://img.shields.io/badge/PL-python?style=flat-square&logo=python&label=Python%203.12&labelColor=yellow&color=black) 
![Django 5.0](https://img.shields.io/badge/Py3k-django?style=flat-square&logo=django&label=Django%205.0&labelColor=green&color=yellow) 
![Django REST framework 3.15](https://img.shields.io/badge/Dj-DRF?style=flat-square&logo=djangorestframework&label=Django%20REST%20framework%203.15&labelColor=red&color=green) 
![PEP8](https://img.shields.io/badge/Py3k-PEP8?style=flat-square&logo=PEP&label=PEP8%20code%20style&labelColor=green&color=yellow) 
![PostgreSQL](https://img.shields.io/badge/DB-pgsql?style=flat-square&logo=postgresql&label=PostgreSQL&labelColor=white&color=black) 
![psycopg2](https://img.shields.io/badge/ORM-psycopg2?style=flat-square&logo=psycopg2&label=psycopg2&labelColor=green&color=black) 
![Git](https://img.shields.io/badge/VCS-Git?style=flat-square&logo=git&label=Git&labelColor=white&color=black) 
![GitHub](https://img.shields.io/badge/Git-GitHub?style=flat-square&logo=github&label=GitHub&labelColor=green&color=white) 
![Serializers](https://img.shields.io/badge/DRF-Serializers?style=flat-square&logo=serializers&label=Serializers&labelColor=orange&color=red) 
![Viewset/Generic](https://img.shields.io/badge/DRF-Viewset/Generic?style=flat-square&logo=viewset/Generic&label=Viewset/Generic&labelColor=orange&color=red) 
![Filter](https://img.shields.io/badge/DRF-Filter?style=flat-square&logo=filter&label=Filter&labelColor=orange&color=red) 
![Tests](https://img.shields.io/badge/DRF-Tests?style=flat-square&logo=tests&label=Tests&labelColor=orange&color=red)
![CORS](https://img.shields.io/badge/-CORS?style=flat-square&logo=CORS&label=CORS&labelColor=green&color=black) 
![README.md](https://img.shields.io/badge/-READMEmd?style=flat-square&logo=readme.md&label=README.md&labelColor=green&color=black) 
![Swagger](https://img.shields.io/badge/-Swagger?style=flat-square&logo=swagger&label=Swagger&labelColor=white&color=black) 
![Postman](https://img.shields.io/badge/-Postman?style=flat-square&logo=postman&label=Postman&labelColor=green&color=black) 
![Docker](https://img.shields.io/badge/-Docker?style=flat-square&logo=docker&label=Docker&labelColor=green&color=black) 



### Особенности
- Сервис реализован на фреймворки Django 5.0.
- Проект использует djangorestframework. 
- Для наследования в сущности пользователь, используется модель `AbstractUser`.
- Настроен CORS.
- Используется Swagger.
- Проект "завёрнут" в Docker.



### Алгоритм запуска сервиса

_Если не использовать Docker_
1. Клонируйте содержимое данного репозитория к себе: `git clone git@github.com:demetriofr/self_study_project.git`

2. .env добавите данные из env.sample.

3. Установите зависимости в venv: `pip3 install -r requirements.txt`.

4. Создайте базу данных, например, через консоль:                                                                                   
   ```                                                                                                                                 
   psql -U postgres                                                                                                                    
   create database self_study_project;
   \q                                                                                               
   ```                                                                                                                                 

5. Сделайте миграции: `python3 manage.py migrate`.

6. Запустите проект: `python3 manage.py runserver`.
                                                                                            
7. Создайте суперюзера использую команду: `python3 manage.py csu`.


_Если использовать Docker_
1. Клонируйте содержимое данного репозитория к себе: `git clone git@github.com:demetriofr/self_study_project.git`

2. .env добавите данные из env.sample.

3. Поднять и собрать проект командой: `docker-compose up -d --build`.

4. Для создания superuser: `docker-compose exec python manage.py csu`.

5. Для остановки проекта, удаления всех контейнеров, сетей и томов: `docker-compose down -v`.



### Реализованные возможности

**Первый этап (_MVP_)**

#### Краткое описание

- Приложение "Рабочие места":
  - Модель "Карты СОУТ".


- Приложение "Организация":
  - Модель "Организация"
  - Модель "Физлицо".
  - Модель "Подразделение".
  - Модель "Должность".
  - Модель "Работник".


- Приложение "Планирование":
  - Модель "Матрица обучений".


- Приложение "Пользователи":
  - Модель "Пользователь".
  - Модель "Группа пользователей".


- Приложение "Материалы".
  - Модель "Допматериал".
  - Модель "Тема".
  - Модель "Модуль". 
  - Модель "Программа".


- Приложение "Проверка знаний"
  - Модель "Вопрос".
  - Модель "Тест".
  - Модель "Тестирование".


**На всех этапах:**
- Управление всеми сущностями через стандартный Django admin.
- Эндпоинты для работы с фронтендом.



### Логика работы сервиса
- Создайте темы обучения с описанием материала, добавлением при необходимости ссылок на НПА или ЛНА с допматериалом 
(не более 13) и указанием количества минут необходимых на прохождение данной темы. 
- Создайте модули обучения с добавлением тем не более или равное 10. 
- Создайте программы обучения с добавлением модулей не более или равное 10.

Например: в качестве темы можно добавить:
```text
Название: "Безопасные методы и приемы выполнения работ электрогазосварщика при воздействии источников опасности, 
идентифицированных в рамках специальной оценки условий труда"

Описание: В котором дать определения: опасности, специальной оценки условий труда, а также перечислить источники 
опасностей с указанием безопасных методов и приёмов выполнения работ.

Ссылка: Указать уникальный номер инструкции по охране труда электрогазосварщика.

Количество минут: 40
```

- Создайте вопросы к теме обучения с указанием вариантов ответов (не более или равное 4) и правильного ответа. 
- Создайте тесты к модулю или программе обучения с указанием количества минут (должно быть не более или равное 20) на 
прохождение вопросов, которых должно быть не более или равное 20. 



#### Некоторые важные понятия
**Тема** (так называемый урок) — максимально логически связанный между собой минималистичный 
материал подготавливающий работника организации по заданной теме.

**Модуль** (так называемый раздел) — объединение схожих тем в один блок для улучшения подготовки, может 
быть дополнен тестом для самопроверки.

**Программа** (так называемый курс) — содержащий модули, которые позволяют освоить курс, может 
быть дополнен тестом для самопроверки. 

**Вопрос** (так называемый закрытый вопрос или тестовое задание) — вопрос с вариантами ответов, ответ на 
который можно найти в указанной к нему теме.

**Тест** — случайным образом формируемые вопросы с вариантами ответов для прохождения, которого требуется определенное 
количество минут или если тест для самопроверки, то без ограничений по времени.



### Функционал

#### Приложение "Рабочие места":

##### Модуль "Карта СОУТ":
- **Администратор** — уникальный номер пользователя в статусе "Администратор", который внёс или изменил карту 
(добавляется уникальный номер активного пользователя). 
- **Номер карты СОУТ** — номер карты СОУТ. 
- **Дата составления карты** — дата составления карты СОУТ. 
- **Класс УТ** — добавляется номер класса условий труда из кортежа (1 - оптимальные; 2 - допустимые; 3.1 - вредные 
условия труда 1 степени; 3.2 - вредные условия труда 2 степени; 3.3 - вредные условия труда 3 степени; 3.4 - вредные 
условия труда 4 степени; 4 - опасные условия труда).

##### Валидаторы
- Дата составления карты СОУТ не должна быть больше даты занесения карты.

##### Эндпоинты
- Создание карты СОУТ.
- Чтение карты СОУТ.
- Чтение списка карт СОУТ.
- Редактирование карты СОУТ.
- Удаление карты СОУТ.


#### Приложение "Физлица":

##### Модуль "Физлицо":
- **Модератор** — уникальный номер модератора, который внёс физлицо (добавляется уникальный номер активного 
пользователя). 
- **Фамилия** — фамилия. 
- **Имя** — имя. 
- **Отчество** — отчество (при наличии). 
- **Дата рождения** — дата рождения. 
- **СНИЛС** (необязательный) — номер СНИЛС. 
- **Электронная почта** (необязательна) — электронная почта физлица. 
- **Телефон** (необязательный) — мобильный телефон физлица.
- **Аватар** (необязательный) — аватар физлица.

##### Валидаторы
- Дата рождения должна меньшей или равной дате, полученной вычитанием 18 лет от даты занесения физлица.

##### Эндпоинты
- Создание физлица.
- Чтение физлица.
- Чтение списка физлиц.
- Редактирование физлица.
- Удаление физлица.


#### Приложение "Организация":

##### Модуль "Организация":
- **Администратор** — уникальный номер пользователя в статусе "Администратор", который внёс или изменил карту 
(добавляется уникальный номер активного пользователя). 
- **Наименование полное** — наименование организации полное согласно уставу. 
- **Наименование сокращенное** (необязательное) — наименование организации сокращенное согласно уставу. 
- **ИНН** (необязательное) — ИНН организации.

##### Модуль "Подразделение":
- **Администратор** — уникальный номер пользователя в статусе "Администратор", который внёс или изменил карту 
(добавляется уникальный номер активного пользователя). 
- **Наименование** — наименование структурного подразделения. 
- **Организация** — уникальный номер организации. 

##### Модуль "Должность":
- **Администратор** — уникальный номер пользователя в статусе "Администратор", который внёс или изменил карту 
(добавляется уникальный номер активного пользователя). 
- **Наименование** — наименование должности. 
- **Подразделение** — уникальный номер подразделение. 
- **Количество** (необязательно) — количество рабочих мест согласно штатному расписанию. 
- **Номер карты СОУТ** (необязательно) — уникальный номер карты СОУТ.
- **Программы** — уникальный номер матрицы обучения.

##### Модуль "Работник":
- **Модератор** — уникальный номер модератора, который добавил работника (добавляется уникальный номер активного 
пользователя). 
- **Физлицо** — уникальный номер физлица.
- **Должность** — уникальный номер должности.
- **Табельный номер** — табельный номер.
- **Дата приёма** (необязательно) — дата приёма на работу.
- **Дата увольнения** (необязательно) — дата увольнения на работу.
- **Сверх программы** (необязательно) — список уникальных номеров программ.

##### Валидаторы
- Дата приёма не должна быть больше даты внесение данных.

##### Эндпоинты
- Создание организации.
- Чтение организации.
- Чтение списка организаций.
- Редактирование организации.
- Удаление организации.
- Создание подразделения.
- Чтение подразделения.
- Чтение списка подразделений.
- Редактирование подразделения.
- Удаление подразделения.
- Создание должности.
- Чтение должности.
- Чтение списка должностей.
- Редактирование должности.
- Удаление должности.
- Создание работника.
- Чтение работника.
- Чтение списка работников.
- Редактирование работника.
- Удаление работника.


#### Приложение "Планирование:

##### Модуль "Матрица обучений":
- **Администратор** — уникальный номер пользователя в статусе "Администратор", который внёс или изменил карту 
(добавляется уникальный номер активного пользователя). 
- **Должность** — уникальный номер должности.
- **Программы** — список уникальных номеров программ.

##### Валидаторы
- Программ не должно быть больше 30.

##### Эндпоинты
- Создание записи в матрицы обучения.
- Чтение записи в матрицы обучения.
- Чтение списка записей в матрицы обучения.
- Редактирование записи в матрицы обучения.
- Удаление записи в матрицы обучения.


#### Приложение "Пользователи:

##### Модуль "Пользователь":
- **Имя пользователя** — имя пользователя для обучающегося создаётся автоматически из данных физлица (фамилия, 
инициалы, год рождения), для администратора и модератора должен быть произвольное допустимое имя пользователя.
- **Пароль** — пароль, создаётся автоматически из данных работника (табельный номер) и данных физлица (дата рождения), 
для администратора и модератора должен быть произвольный допустимый пароль.
- **Данные работника** — уникальный номер работника.
- **Статус администратора** (булево значение, по-умолчанию False) — статус администратора может быть 
получен только при регистрации в Django admin.
- **Статус модератора** (булево значение, по-умолчанию False) — статус модератора.
- **Статус обучающегося** (булево значение, по-умолчанию True) — статус обучающегося.
- **Статус удален** (булево значение, по-умолчанию False) — статус для "мягкого" удаления пользователя.
- **Группы пользователей** (необязательна) — список уникальных номеров групп пользователей.
- **Создатель** — уникальный номер пользователя в статусе "Администратор" или "Модератора", который добавил 
пользователя (добавляется уникальный номер активного пользователя).
- **Доп. программы** (необязательно) — список уникальных номеров программ.
- **Доп. тесты** (необязателен) — список уникальные номера программ.


##### Модуль "Группа пользователей":
- **Имя группы** — наименование группы пользователей.
- **Статус** — статус группы (администраторы, модераторы или обучающиеся).
- **Список пользователей** — список уникальных номеров пользователей, перечисляются уникальные номера администратором 
для групп модераторов и модераторами для групп обучающихся.
- **Список программ** (необязателен) — список уникальных номеров программ.
- **Создатель** — уникальный номер пользователя в статусе "Администратор" или "Модератора", который добавил 
группу (добавляется уникальный номер активного пользователя).


##### Права пользователей
###### В статусе "Обучающиеся":
* **Имеет** доступ по механизму CRUD к назначенным им:
  - программам в модели "Программы" приложения "Материалы" (только просмотр).
  - тестам в модели "Тест" приложения "Проверка знаний" (только просмотр).
  - тестированию в модель "Тестирования" приложения "Проверка знаний" (только создание и просмотр результатов).
* **Может** видеть список доступных всем программам и тестов, а также может добавлять себе публичные программы и тесты.

###### В статусе "Модератор":
* **Имеет** доступ по механизму CRUD к моделям в приложениях:
  - "Организация" которые создал сам, открыты администратором для группы 
  - "Физлица" (за исключением удаления "Физлица") которые создал сам, открыты администратором для группы 
модераторов.
  - "Пользователи" (к модели "Пользователь" и к модели "Группа пользователей" только взаимодействовать с пользователями 
  в статусе "Обучающихся")
  - "Материалы", 
  - "Проверка знаний" (за исключением создания, редактирования и удаление в модели "Результат"), 

* **Может** видеть список доступных всем программам и тестов, а также результаты назначенных ими самим обучающихся без 
возможности их как-то редактировать или удалять. 

###### В статусе "Администратор":
* **Имеет** доступ по механизму CRUD к моделям в приложениях:
  - "Рабочие места". 
  - "Физлица". 
  - "Организация". 
  - "Планирование". 
  - "Пользователи" (кроме пользователей в статусе "Обучающиеся" для которой возможен только просмотр). 
  - "Материалы" (только просмотр).
  - "Проверка знаний" (только модель "Результат" для остальных только просмотр).
* **Может** быть модератором.

##### Валидаторы
- Запрет на получения статуса администратора через механизм CRUD.
- К модератору и группе пользователей со статусом модераторов имеют доступ по механизму CRUD только администратор.
- К своим обучающемся и группе пользователей со статусом обучающихся имеют доступ по механизму CRUD только модераторы.
- Администратор и модератор не могут быть обучающимися.
- Доп. программы и тесты добавляет себя только обучающийся.

##### Эндпоинты
- Создание модераторов.
- Чтение модераторов.
- Чтение списка модераторов.
- Редактирование модераторов.
- Удаление модераторов.
- Создание обучающихся.
- Чтение обучающихся.
- Чтение списка обучающихся.
- Редактирование обучающихся.
- Удаление обучающихся.

                                                                                                                                    
#### Приложение "Материалы"

##### Модель "Допматериал":
- **Модератор** — уникальный номер модератора, который создал допматериал (добавляется уникальный номер активного 
пользователя).
- **Название** — название допматериала.
- **Вид** — вид допматериала (НПА, ЛНА или другое).
- **Ссылка** — ссылка на НПА, ЛНА или другой допматериал.
- **Статус публичности** (булево значение, по-умолчанию False) — статус публичности, доступности для 
самостоятельного выбора и прохождения.

##### Модель "Тема":
- **Модератор** — уникальный номер модератора, который создал тему (добавляется уникальный номер активного 
пользователя).
- **Название** — название темы.
- **Описание** (необязательно) — описание темы.
- **Материал** — материал необходимый для подготовки по данной теме.
- **Допматериал** (необязательна) — уникальные номера на допматериал, НПА или ЛНА.
- **Время** — количество минут для прохождения темы.

##### Модель "Модуль":
- **Модератор** — уникальный номер модератора, который создал модуль (добавляется уникальный номер активного 
пользователя).
- **Название** — название модуля.
- **Описание** (необязательно) — описание модуля.
- **Темы** — список уникальных номеров тем.
- **Тест для самопроверки** (необязательный) — список уникальных номеров тестов для самопроверки по данному модулю.

##### Модель "Программа":
- **Модератор** — уникальный номер модератора, который создал программу (добавляется уникальный номер активного 
пользователя).
- **Название** — название программы.
- **Описание** (необязательно) — описание программы.
- **Модули** — список уникальных номеров модулей.
- **Тест для самопроверки** (необязательный) — список уникальных номеров тестов для самопроверки по данной программе.
- **Статус публичности** (булево значение, необязательный и по-умолчанию False) — статус публичности, доступности для 
самостоятельного выбора и прохождения.
- 
##### Валидаторы
- Создателем темы может быть только модератор.
- Количество допматериала не должно быть больше 13.
- Количество минут для прохождения темы не должно быть меньше 5 и больше 60 минут.
- Тем в модуле и программе не должно быть больше 10.
- Тест для самопроверки должен быть тестом у которого отсутствует время на его прохождение.
- Тест для самопроверки должен быть тестом для модуля при добавлении в модуль и тестом для программы при добавлении в 
программу.

### Эндпоинты
- Создание допматериала.
- Чтение допматериала.
- Чтение списка допматериалов для текущего пользователя.
- Чтение списка допматериалов модератора.
- Чтение публичных допматериалов.
- Редактирование допматериала.
- Удаление допматериала.
- Создание темы.
- Чтение темы.
- Чтение список тем для текущего пользователя.
- Чтение списка тем модератора.
- Редактирование темы.
- Удаление темы.
- Создание модуля.
- Чтение модуля.
- Чтение список модулей для текущего пользователя.
- Чтение списка модулей модератора.
- Редактирование модуля.
- Удаление модуля.
- Создание программы.
- Чтение программы.
- Чтение списка программ для текущего пользователя.
- Чтение списка программ модератора.
- Чтение публичных программ.
- Редактирование программы.
- Удаление программы.


#### Приложение "Проверка знаний:

##### Модуль "Вопрос":
- **Модератор** — уникальный номер модератора, который создал вопрос (добавляется уникальный номер активного 
пользователя). 
- **Вопрос** — наименование вопроса. 
- **Вариант ответа А** — вариант ответа на вопрос. 
- **Вариант ответа Б** — вариант ответа на вопрос. 
- **Вариант ответа В** (необязателен) — вариант ответа на вопрос. 
- **Вариант ответа Г** (необязателен) — вариант ответа на вопрос. 
- **Правильный ответ** — правильный ответ (указывает на вариант ответа (А, Б, В или Г)). 
- **Тема** — уникальный номер темы, знание которой проверяет вопрос. 
- **Пояснения** (необязательно) — пояснения, которые помогают разобраться в ответе на данный вопрос. 

##### Модуль "Тест":
- **Модератор** — уникальный номер модератора, который создал тест (добавляется уникальный номер активного 
пользователя).
- **Наименование** — наименование теста. 
- **Описание** (необязателен) — описание теста. 
- **Модуль** (необязателен) — уникальный номер модуля, знание которой проверяет тест. 
- **Программа** (необязательна) — уникальный номер программы, знание которой проверяет тест. 
- **Вопросы** — список уникальных номеров вопросов.
- **Самопроверка** (булево значение, необязательна и по-умолчанию False) — самопроверка или нет.
- **Время** (необязательно) — время на прохождение теста добавляется автоматически (на 1 вопрос даётся 1 минута).

##### Модуль "Тестирование":
- **Обучающийся** — уникальный номер обучающегося, который прошёл тестирование (добавляется уникальный номер активного 
пользователя).
- **Тест** — уникальный номер теста. 
- **Ответы на вопросы** — словарь с ключом (уникальный номер вопроса) и значением (ссылка на поле А, Б, В или Г).
- **Подсчёт** - количество правильных ответов, подсчитывается автоматически.
- **Результат** — результат "Сдал", если правильных ответов больше, либо равное 80%, а если менее, то "Не сдал"

##### Валидаторы
- Создателем вопроса может быть только модератор.
- Количество ответов на вопрос может быть больше 2, но не большее 4.
- Полученный ответ должен ссылаться на один из 4 ответов.
- У теста должен быть модуль или программа.
- Вопросов должно быть не менее 5, но не больше 20.
- Должно быть указано время если самопроверка в значение "False" и наоборот.

### Эндпоинты

- Создание вопроса.
- Чтение вопроса.
- Чтение списка вопросов модератора.
- Чтение списка вопросов для обучающего по заданной теме.
- Чтение списка вопросов с ответами и правильным ответ для обучающего по заданной теме.
- Редактирование вопроса.
- Удаление вопроса.
- Создание теста.
- Чтение теста.
- Чтение списка тестов модератора.
- Чтение списка тестов для обучающихся.
- Чтение списка публичных тестов для обучающихся.
- Редактирование теста.
- Удаление теста.
- Создание тестирования.
- Чтение тестирования.
- Чтение списка результатов тестирования для выбранного пользователя или по-умолчанию для текущего.
- Редактирование тестирования.
- Удаление тестирования.



#### Пагинация
Для вывода всех списков реализована пагинация с выводом по 5 привычек на страницу.



### Безопасность
Для проекта настроен CORS, чтобы фронтенд мог подключаться к проекту на развернутом сервере.



### Документация
Для реализации экранов силами фронтенд-разработчиков настроен вывод документации.



### Данный проект это завершающая работа (диплом) в курсе "Python-разработчик"                                              
_Данный учебный проект состоит из одной части._                                                                                     

### Описание задач
- [ ] Реализовать функционал самообучения для обучающихся. 
- [ ] Создать платформу, которая работает только с авторизованными пользователями. 
- [ ] На платформе необходимо предусмотреть функционал программ, модулей и тем.
- [ ] Сделать возможность для каждого модуля и программы добавлять тесты.
- [ ] Проверка ответа на тест осуществляется с помощью отдельного запроса на бэкенд.
- [ ] Управление всеми сущностями реализовать через стандартный Django admin.
- [ ] Реализовать Rest API.
- [ ] Использовать фреймворк Django. 
                                                                                                                                     
**Критерии успешного выполнения данной курсовой:**                                                                                                               
- [x] Настроена CORS.
- [x] Настроен Swagger UI.
- [ ] Реализована пагинация.
- [x] Использовано переменные окружения.
- [ ] Все необходимые модели описаны или переопределены.
- [ ] Все необходимые эндпоинты реализованы.
- [ ] Настроены все необходимые валидаторы.
- [ ] Описаны права доступа.
- [ ] Проект покрыт тестами как минимум на 80%.
- [ ] Код оформлен в соответствии с лучшими практиками.
- [x] Имеется список зависимостей.
- [ ] Результат проверки Flake8 равен 100%, при исключении миграций.
- [ ] Решение выложили на GitHub. 



### Справочно:
```text
Product lifecycle:

MVP (Minimum Viable Product - Минимально Жизнеспособный Продукт) - это отправная точка, так называемая базовая версию 
проекта, которая решать основную проблему пользователей.

MMP (Minimum Marketable Product - Минимально Маркетинговый Продукт) - это расширяет MVP до уровня, на котором проект 
становится привлекательным для использования.

MLP (Minimum Lovable Product - Минимально Любимый Продукт) - это версия проекта, которая не только решает проблемы 
пользователей, но и делает это таким образом, что пользователи влюбляются в проект.
```
